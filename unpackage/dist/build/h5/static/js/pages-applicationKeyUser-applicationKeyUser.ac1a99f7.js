(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-applicationKeyUser-applicationKeyUser"],{"0843":function(t,n,e){"use strict";var i=e("58ca"),a=e.n(i);a.a},"1e28":function(t,n,e){"use strict";e.r(n);var i=e("5206"),a=e.n(i);for(var o in i)"default"!==o&&function(t){e.d(n,t,(function(){return i[t]}))}(o);n["default"]=a.a},"364c":function(t,n,e){"use strict";e.r(n);var i=e("788e"),a=e("1e28");for(var o in a)"default"!==o&&function(t){e.d(n,t,(function(){return a[t]}))}(o);e("0843");var s,l=e("f0c5"),c=Object(l["a"])(a["default"],i["b"],i["c"],!1,null,"3d1a9115",null,!1,i["a"],s);n["default"]=c.exports},5206:function(t,n,e){"use strict";e("99af"),e("4160"),e("a434"),e("159b"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("567f"),a=i.util,o=i.factory,s=i.constant,l={data:function(){return{index:-1,indexIdent:-1,indexExpiry:-1,locations:[],communityId:"",showTypeCd:!1,typeCdList:["业主","家庭成员","租客"],typeCdName:"业主",sexList:["男","女"],showSex:!1,showExpiry:!1,expiryList:["一个月","半年","一年"],photoList:[],name:"",age:null,sex:"男",typeCd:"10004",idCard:"",startTime:null,endTime:null,tel:"",photos:[],msgCode:"",imgList:[],expiry:""}},components:{},props:{},onLoad:function(t){var n=this;i.getOwner((function(t){n.name=t.appUserName,n.idCard=t.idCard,n.tel=t.link})),this.locations=JSON.parse(t.locations),this.communityId=t.communityId},onReady:function(){},onShow:function(){var t=a.date.formatTime(new Date);this.startTime=t},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){},methods:{PickerChange:function(t){this.index=t.detail.value},PickerIdentChange:function(t){this.indexIdent=t.detail.value},PickerExpiryChange:function(t){this.indexExpiry=t.detail.value},ChooseImage:function(){var t=this;uni.chooseImage({count:2,sizeType:["original","compressed"],sourceType:["album"],success:function(n){0!=t.imgList.length?t.imgList=t.imgList.concat(n.tempFilePaths):t.imgList=n.tempFilePaths}})},ViewImage:function(t){uni.previewImage({urls:this.imgList,current:t.currentTarget.dataset.url})},DelImg:function(t){var n=this;uni.showModal({title:"删除确认",content:"确定要删除这个图片吗？",cancelText:"取消",confirmText:"删除",success:function(e){e.confirm&&n.imgList.splice(t.currentTarget.dataset.index,1)}})},bindInput:function(t){console.log("数据监听",t);var n=this,e=t.currentTarget.dataset,i=t.detail.value,a=e.name;n[a]=i,console.log(this)},sendMsgCode:function(){},chooseTypeCd:function(){this.showTypeCd=!0},onConfirm:function(t){console.log("onConfirm",t);var n="";n=0==t.detail.index?"10004":1==t.detail.index?"10005":"10006",this.showTypeCd=!1,this.typeCd=n,this.typeCdName=t.detail.value},onChange:function(t){console.log(t)},onCancel:function(t){this.showTypeCd=!1},chooseSex:function(){this.showSex=!0},onSexConfirm:function(t){console.log("onConfirm",t),this.showSex=!1,this.sex=t.detail.value},onSexChange:function(t){console.log(t)},onSexCancel:function(t){this.showSex=!1},chooseExpiry:function(){this.showExpiry=!0},onExpiryConfirm:function(t){console.log("onConfirm",t);var n=null;n="一个月"==t.detail.value?a.date.formatTime(a.date.addMonth(new Date,1)):"半年"==t.detail.value?a.date.formatTime(a.date.addMonth(new Date,6)):a.date.formatTime(a.date.addYear(new Date,1)),this.showExpiry=!1,this.expiry=t.detail.value,this.endTime=n},onExpiryChange:function(t){console.log(t)},onExpiryCancel:function(t){this.showExpiry=!1},afterRead:function(t){var n=t.detail.file,e=this,i=this.photoList,a=void 0===i?[]:i;a.push(n),this.photoList=a,o.base64.urlTobase64(n.path).then((function(t){e.photos.push(t)})),console.log("data信息：",this)},removePhoto:function(t){console.log(t.detail.index);var n=[];this.photoList.forEach((function(e,i){i!=t.detail.index&&n.push(e)}));var e=[];this.photos.forEach((function(n,i){i!=t.detail.index&&e.push(n)})),this.photos=e,this.photoList=n},saveApplicationKey:function(){var t={name:this.name,age:this.age,sex:"男"==this.sex?1:0,typeCd:this.typeCd,idCard:this.idCard,startTime:this.startTime,endTime:this.endTime,tel:this.tel,photos:[],msgCode:this.msgCode,communityId:this.communityId,machineIds:[],typeFlag:"1100102"};console.log(t);var n=this.photos;n.forEach((function(n){t.photos.push({photo:n})}));var e="";""==t.name&&(e="请填写名称"),null==t.age&&(e="请填写年龄"),""==t.sex&&(e="请选择性别"),""==t.typeCd&&(e="请选择身份"),""==t.idCard&&(e="请填写身份证"),null==t.startTime&&(e="请选择有效期"),null==t.endTime&&(e="请选择有效期"),""==t.tel&&(e="请选择填写手机号"),(null==t.photos||t.photos.length<2)&&(e="请选择证件照片"),""==t.msgCode&&(e="请填写验证码"),(null==this.locations||this.locations.length<1)&&(e="没有设备可申请钥匙"),""==e?(this.locations.forEach((function(n){t.machineIds.push({machineId:n.machineId})})),console.log(t),i.request({url:s.url.applyApplicationKey,header:i.getHeaders(),method:"POST",data:t,success:function(t){console.log("请求返回信息：",t),200!=t.statusCode?wx.showToast({title:"服务器异常了",icon:"none",duration:2e3}):wx.redirectTo({url:"/pages/applicationKeyProgress/applicationKeyProgress"})},fail:function(t){wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}})):wx.showToast({title:e,icon:"none",duration:2e3})}}};n.default=l},"58ca":function(t,n,e){var i=e("b956");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=e("4f06").default;a("b21395c4",i,!0,{sourceMap:!1,shadowMode:!1})},"788e":function(t,n,e){"use strict";var i,a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",[e("v-uni-view",{staticClass:"block__title"},[t._v("业主信息")]),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("姓名")]),e("v-uni-input",{attrs:{value:t.name,"data-name":"name",required:!0,label:"姓名",clearable:!0,placeholder:"请输入名称",name:"name"},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.bindInput.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("年龄")]),e("v-uni-input",{attrs:{value:t.age,"data-name":"age",type:"number",label:"年龄",placeholder:"请输入年龄",required:!0,clearable:!0,name:"age"},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.bindInput.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("性别")]),e("v-uni-picker",{attrs:{value:t.sex,range:t.sexList},on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.PickerChange.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"picker",on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.onSexChange.apply(void 0,arguments)},cancel:function(n){arguments[0]=n=t.$handleEvent(n),t.onSexCancel.apply(void 0,arguments)},confirm:function(n){arguments[0]=n=t.$handleEvent(n),t.onSexConfirm.apply(void 0,arguments)}}},[t._v(t._s(t.index>-1?t.sexList[t.index]:"请选择性别"))])],1)],1),e("v-uni-view",{staticClass:"block__title"},[t._v("身份信息")]),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("身份")]),e("v-uni-picker",{attrs:{value:t.typeCdName,range:t.typeCdList},on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.PickerIdentChange.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"picker",on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.onChange.apply(void 0,arguments)},cancel:function(n){arguments[0]=n=t.$handleEvent(n),t.onCancel.apply(void 0,arguments)},confirm:function(n){arguments[0]=n=t.$handleEvent(n),t.onConfirm.apply(void 0,arguments)}}},[t._v(t._s(t.indexIdent>-1?t.typeCdList[t.indexIdent]:"请选择身份"))])],1)],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("身份证")]),e("v-uni-input",{attrs:{value:t.idCard,"data-name":"idCard",required:!0,label:"身份证",clearable:!0,placeholder:"请输入身份证",name:"idCard"},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.bindInput.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("有效期")]),e("v-uni-picker",{attrs:{value:t.expiry,range:t.expiryList},on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.PickerExpiryChange.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"picker",on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.onChange.apply(void 0,arguments)},cancel:function(n){arguments[0]=n=t.$handleEvent(n),t.onCancel.apply(void 0,arguments)},confirm:function(n){arguments[0]=n=t.$handleEvent(n),t.onConfirm.apply(void 0,arguments)}}},[t._v(t._s(t.indexExpiry>-1?t.expiryList[t.indexExpiry]:"请选择有效期"))])],1)],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("手机号")]),e("v-uni-input",{attrs:{value:t.tel,"data-name":"tel",required:!0,label:"手机号",clearable:!0,placeholder:"请输入手机号",name:"tel"},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.bindInput.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("验证码")]),e("v-uni-input",{attrs:{value:t.msgCode,"data-name":"msgCode",required:!0,label:"验证码",clearable:!0,placeholder:"请输入验证码",name:"msgCode"},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.bindInput.apply(void 0,arguments)}}}),e("v-uni-button",{staticClass:"cu-btn sm",attrs:{slot:"button",type:"number",size:"small"},nativeOn:{tap:function(n){return n.stopPropagation(),t.sendMsgCode(n)}},slot:"button"},[t._v("申请钥匙")])],1),e("v-uni-view",{staticClass:"block__title"},[t._v("证件照片")]),e("v-uni-view",{staticClass:"cu-bar bg-white margin-top"},[e("v-uni-view",{staticClass:"action"},[t._v("请上传身份证正反面")]),e("v-uni-view",{staticClass:"action"},[t._v(t._s(t.imgList.length)+"/2")])],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"grid col-2 grid-square flex-sub"},[t._l(t.imgList,(function(n,i){return e("v-uni-view",{key:i,staticClass:"bg-img",attrs:{"data-url":t.imgList[i]},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.ViewImage.apply(void 0,arguments)}}},[e("v-uni-image",{attrs:{src:t.imgList[i],mode:"aspectFill"}}),e("v-uni-view",{staticClass:"cu-tag bg-red",attrs:{"data-index":i},on:{click:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.DelImg.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)})),t.imgList.length<2?e("v-uni-view",{staticClass:"solids",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.ChooseImage.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):t._e()],2)],1),e("v-uni-view",{staticClass:"button_up_blank"}),e("v-uni-view",{staticClass:"padding flex flex-direction"},[e("v-uni-button",{staticClass:"cu-btn bg-green lg",nativeOn:{tap:function(n){return n.stopPropagation(),t.saveApplicationKey(n)}}},[t._v("提交申请")])],1),e("v-uni-view",{staticClass:"button_up_blank"})],1)},o=[];e.d(n,"b",(function(){return a})),e.d(n,"c",(function(){return o})),e.d(n,"a",(function(){return i}))},b956:function(t,n,e){var i=e("24fb");n=i(!1),n.push([t.i,".block__title[data-v-3d1a9115]{margin:0;font-weight:400;font-size:14px;color:rgba(69,90,100,.6);padding:%?60?% %?30?% %?20?%}.button_up_blank[data-v-3d1a9115]{height:%?40?%}.aku_photo_view[data-v-3d1a9115]{background-color:#fff;height:%?250?%;padding:%?40?% 0 %?40?% %?40?%}.aku_photo_view uni-text[data-v-3d1a9115]{font-size:%?30?%;color:#8a8a8a}",""]),t.exports=n}}]);